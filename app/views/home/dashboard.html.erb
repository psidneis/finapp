<%= render 'header' %>
<%  
	date_format = l(@search_period, format: :long_day_month_year) if @search_period_type == 'day'
	date_format = l(@search_period, format: :long_month_year) if @search_period_type == 'month'
	date_format = "#{l(@start_date, format: :long_week_month)} à #{l(@end_date, format: :long_week_month)}" if @search_period_type == 'week'
	date_format = "#{l(@start_date, format: :default)} à #{l(@end_date, format: :default)}" if @search_period_type == 'period'
%>

<nav class='text-center'>
		<div class='btn-group'>
				<% if @search_period_type != 'period' %>
			    <%= link_to "<i class='icon-chevron-left'></i>".html_safe, home_dashboard_path(search_period_type: @search_period_type, search_period: @search_period - 1.send("#{@search_period_type}")), class: 'btn btn-success btn-md previous' %>
			   <% end %>
		  <div class='btn-group dropdown'>
		    <button class='btn btn-success btn-md dropdown-toggle' data-delay='100' data-hover='dropdown' data-toggle='dropdown'>
		      <%= date_format %>
		      <span class='caret'></span>
		    </button>
		    <ul class='dropdown-menu'>
		      <li>
		        <%= link_to t('datetime.prompts.day'),  home_dashboard_path(search_period_type: 'day')%>
		      </li>
		      <li>
		        <%= link_to t('datetime.prompts.week'),  home_dashboard_path(search_period_type: 'week')%>
		      </li>
		      <li>
		        <%= link_to t('datetime.prompts.month'),  home_dashboard_path(search_period_type: 'month')%>
		      </li>
		      <li>
		        <%= link_to 'Por período', "#", data: {toggle: 'modal', target: '#search_period_modal'} %>
		      </li>
		    </ul>
		  </div>
		  <% if @search_period_type != 'period' %>
			  <%= link_to "<i class='icon-chevron-right'></i>".html_safe, home_dashboard_path(search_period_type: @search_period_type, search_period: @search_period + 1.send("#{@search_period_type}")), class: 'btn btn-success btn-md next' %>
			 <% end %>
		</div>
</nav>

<!-- Modal -->
<div class="modal fade" id="search_period_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel"><%= t('breadcrumbs.pages.search_by_period') %></h4>
      </div>
      <div class="modal-body">
        <div class="container">
			    <div class='col-md-5'>
		        <div class="form-group">
	            <div class='input-group date' id='datetimepicker_from'>
	              <input type='text' class="form-control" />
	              <span class="input-group-addon">
	                <span class="glyphicon glyphicon-calendar"></span>
	              </span>
	            </div>
		        </div>
			    </div>
			    <div class='col-md-5'>
		        <div class="form-group">
	            <div class='input-group date' id='datetimepicker_to'>
	              <input type='text' class="form-control" />
	              <span class="input-group-addon">
	                <span class="glyphicon glyphicon-calendar"></span>
	              </span>
	            </div>
		        </div>
			    </div>
				</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <%= link_to t('helpers.links.search'), '#', class: 'btn btn-success', id: 'search_period_modal_link', data: { url: home_dashboard_path() } %>
      </div>
    </div>
  </div>
</div>


<%= render 'accounts/list_dashboard' %>

<%= render 'installments/list_dashboard' %>

<script type="text/javascript">
  $(function () {
    $('#datetimepicker_from').datetimepicker({ format: 'DD/MM/YYYY HH:mm' });
    $('#datetimepicker_to').datetimepicker({
        useCurrent: false, format: 'DD/MM/YYYY HH:mm' //Important! See issue #1075
    });
    $("#datetimepicker_from").on("dp.change", function (e) {
        $('#datetimepicker_to').data("DateTimePicker").minDate(e.date);
    });
    $("#datetimepicker_to").on("dp.change", function (e) {
        $('#datetimepicker_from').data("DateTimePicker").maxDate(e.date);
    });
  });
</script>
